<app-navbar-crm></app-navbar-crm>
<div class="container" style="background-color: white;">
    <div class="row pt-4 pb-4 ">
        <div class="col-sm-6">
           <h2 class="text-center" style="font-weight: bold; color:rgb(104, 100, 100);"> {{trato.nombre}} </h2>             
        </div>
        <div *ngIf="trato.estado==0" class="col-sm-6 text-center">
            <i class="fa fa-check-square-o mr-5 ml-4 fa-2x" (click)="assign(trato,true)" style="color:green;float:right" aria-hidden="true"></i>                        
            <i class="fa fa-ban fa-2x" (click)="assign(trato,false)" style="color:red;float:right" aria-hidden="true"></i>
            <span class="mr-4" style="float:right; font-weight: bold; color:rgb(104, 100, 100);">Estado: </span>
        </div>
        <div data-toggle="modal" data-target="#reabrirModal" *ngIf="trato.estado==1" class="col-sm-6 reabrir text-center">
            <i class="fa fa-check-square-o mr-5 ml-4 fa-2x"  style="color:green;float:right" aria-hidden="true"></i>                        
            <span class="mr-4" style="float:right; font-weight: bold; color:rgb(104, 100, 100);">Estado (reabrir): </span>
        </div>
        <div data-toggle="modal" data-target="#reabrirModal" *ngIf="trato.estado==2" class="col-sm-6 reabrir text-center">
            <i class="fa fa-ban fa-2x"  style="color:red;float:right" aria-hidden="true"></i>
            <span class="mr-4" style="float:right; font-weight: bold; color:rgb(104, 100, 100);">Estado (reabrir): </span>
        </div>
    </div>
    <div class="row align-items-center pb-5">
        <div class="col-sm text-center">
           <p> <span style="font-weight: bold;">Cliente: </span> {{trato.cliente?.nombre}} </p>             
           <p> <span style="font-weight: bold;">Vendedor: </span> {{trato.vendedor?.username}} </p>             
        </div>
        <div class="col-sm text-center">
            <p *ngIf="desc" class="desc" (click)="desc=!desc"> <span style="font-weight: bold;">Descripci√≥n: </span> {{trato.descripcion}}<i class="fa fa-pencil" aria-hidden="true"></i></p>    
            <textarea *ngIf="!desc" rows="2" type="text" [(ngModel)]="trato.descripcion" (blur)="desc=!desc;assignDesc(trato)"></textarea>
            <br>
            <p *ngIf="trato.nota!=' '"> <span style="font-weight: bold;">Nota reapertura: </span> {{trato.nota}}</p>    
        </div>
    </div>
    <div class="row align-items-center pb-4">
        <div class="col text-center">
            <h3 style="font-weight: bold; color:#33ACE2">Subtareas</h3>
        </div>
    </div>
</div>
<app-footer-crm></app-footer-crm>



<div class="modal fade" id="reabrirModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLongTitle">Nota</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
       
            <form class="form-product">             
              <div class="form-group">
                <label for="descripcion">Motivos reapertura del trato: </label>
                <textarea  [(ngModel)]="trato.nota" name="descripcion" type="text" class="form-control" 
                id="descripcion" placeholder="Ingresa la descripcion" rows="2"></textarea>
              </div>           
            </form>
          
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
          <button type="button" (click)="assignNota(trato)" data-dismiss="modal" class="btn btn-primary">Crear</button>
        </div>
      </div>
    </div>
  </div>